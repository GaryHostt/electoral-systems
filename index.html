<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electoral Systems Simulator</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="comparison.css">
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ—³ï¸ Electoral Systems Simulator</h1>
            <p class="subtitle">Compare different voting systems and understand their implications</p>
            <div style="margin-top: 15px;">
                <a href="learn-more.html" class="learn-more-btn" target="_blank">
                    ğŸ“š Learn More About Electoral Systems
                </a>
            </div>
        </header>

        <div class="main-content">
            <!-- Electoral System Selection -->
            <section class="card">
                <h2>1. Choose Electoral System</h2>
                <select id="electoralSystem" class="system-select">
                    <option value="">-- Select an Electoral System --</option>
                    <option value="fptp">First-Past-the-Post (FPTP) / Single-Member Plurality (SMP)</option>
                    <option value="irv">Instant-Runoff Voting (IRV) / Ranked-Choice Voting (RCV)</option>
                    <option value="party-list">Party-List Proportional Representation (PR)</option>
                    <option value="stv">Single Transferable Vote (STV)</option>
                    <option value="mmp">Mixed-Member Proportional (MMP) / Additional Member System (AMS)</option>
                    <option value="parallel">Parallel Voting / Mixed-Member Majoritarian (MMM)</option>
                </select>
                <div id="systemDescription" class="system-description"></div>
            </section>

            <!-- Party Management Section -->
            <section class="card" id="partiesSection" style="display: none;">
                <h2><span class="section-number">2</span>. Political Parties</h2>
                
                <!-- Import Countries Feature - Collapsible -->
                <div class="country-import-container">
                    <button onclick="toggleCountryImport()" class="country-toggle-btn">
                        <span id="countryToggleIcon">â–¶</span> ğŸŒ Import Political Parties from Country
                    </button>
                    
                    <div id="countryImportPanel" class="country-import-panel" style="display: none;">
                        <p style="margin-bottom: 15px; color: #666;">Select a country to import its major political parties with authentic names and colors:</p>
                        <div class="country-grid">
                            <button onclick="importCountryParties('USA')" class="country-btn">
                                <span class="country-flag">ğŸ‡ºğŸ‡¸</span>
                                <span class="country-name">USA</span>
                                <span class="country-count">4 parties</span>
                            </button>
                            <button onclick="importCountryParties('Canada')" class="country-btn">
                                <span class="country-flag">ğŸ‡¨ğŸ‡¦</span>
                                <span class="country-name">Canada</span>
                                <span class="country-count">5 parties</span>
                            </button>
                            <button onclick="importCountryParties('Taiwan')" class="country-btn">
                                <span class="country-flag">ğŸ‡¹ğŸ‡¼</span>
                                <span class="country-name">Taiwan</span>
                                <span class="country-count">4 parties</span>
                            </button>
                            <button onclick="importCountryParties('France')" class="country-btn">
                                <span class="country-flag">ğŸ‡«ğŸ‡·</span>
                                <span class="country-name">France</span>
                                <span class="country-count">6 parties</span>
                            </button>
                            <button onclick="importCountryParties('Germany')" class="country-btn">
                                <span class="country-flag">ğŸ‡©ğŸ‡ª</span>
                                <span class="country-name">Germany</span>
                                <span class="country-count">6 parties</span>
                            </button>
                            <button onclick="importCountryParties('Chile')" class="country-btn">
                                <span class="country-flag">ğŸ‡¨ğŸ‡±</span>
                                <span class="country-name">Chile</span>
                                <span class="country-count">6 parties</span>
                            </button>
                            <button onclick="importCountryParties('Spain')" class="country-btn">
                                <span class="country-flag">ğŸ‡ªğŸ‡¸</span>
                                <span class="country-name">Spain</span>
                                <span class="country-count">5 parties</span>
                            </button>
                            <button onclick="importCountryParties('Italy')" class="country-btn">
                                <span class="country-flag">ğŸ‡®ğŸ‡¹</span>
                                <span class="country-name">Italy</span>
                                <span class="country-count">6 parties</span>
                            </button>
                            <button onclick="importCountryParties('Finland')" class="country-btn">
                                <span class="country-flag">ğŸ‡«ğŸ‡®</span>
                                <span class="country-name">Finland</span>
                                <span class="country-count">8 parties</span>
                            </button>
                            <button onclick="importCountryParties('Austria')" class="country-btn">
                                <span class="country-flag">ğŸ‡¦ğŸ‡¹</span>
                                <span class="country-name">Austria</span>
                                <span class="country-count">5 parties</span>
                            </button>
                            <button onclick="importCountryParties('Portugal')" class="country-btn">
                                <span class="country-flag">ğŸ‡µğŸ‡¹</span>
                                <span class="country-name">Portugal</span>
                                <span class="country-count">5 parties</span>
                            </button>
                            <button onclick="importCountryParties('Poland')" class="country-btn">
                                <span class="country-flag">ğŸ‡µğŸ‡±</span>
                                <span class="country-name">Poland</span>
                                <span class="country-count">6 parties</span>
                            </button>
                            <button onclick="importCountryParties('Ireland')" class="country-btn">
                                <span class="country-flag">ğŸ‡®ğŸ‡ª</span>
                                <span class="country-name">Ireland</span>
                                <span class="country-count">5 parties</span>
                            </button>
                            <button onclick="importCountryParties('Estonia')" class="country-btn">
                                <span class="country-flag">ğŸ‡ªğŸ‡ª</span>
                                <span class="country-name">Estonia</span>
                                <span class="country-count">5 parties</span>
                            </button>
                            <button onclick="importCountryParties('Latvia')" class="country-btn">
                                <span class="country-flag">ğŸ‡±ğŸ‡»</span>
                                <span class="country-name">Latvia</span>
                                <span class="country-count">6 parties</span>
                            </button>
                            <button onclick="importCountryParties('Lithuania')" class="country-btn">
                                <span class="country-flag">ğŸ‡±ğŸ‡¹</span>
                                <span class="country-name">Lithuania</span>
                                <span class="country-count">6 parties</span>
                            </button>
                            <button onclick="importCountryParties('Sweden')" class="country-btn">
                                <span class="country-flag">ğŸ‡¸ğŸ‡ª</span>
                                <span class="country-name">Sweden</span>
                                <span class="country-count">8 parties</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="input-group">
                    <input type="text" id="partyName" placeholder="Party name (e.g., Progressive Party)">
                    <div class="color-picker-wrapper">
                        <div class="color-presets" id="colorPresets">
                            <button type="button" class="color-preset" data-color="#e74c3c" style="background: #e74c3c;" title="Red"></button>
                            <button type="button" class="color-preset" data-color="#3498db" style="background: #3498db;" title="Blue"></button>
                            <button type="button" class="color-preset" data-color="#2ecc71" style="background: #2ecc71;" title="Green"></button>
                            <button type="button" class="color-preset" data-color="#f39c12" style="background: #f39c12;" title="Orange"></button>
                            <button type="button" class="color-preset" data-color="#9b59b6" style="background: #9b59b6;" title="Purple"></button>
                            <button type="button" class="color-preset" data-color="#1abc9c" style="background: #1abc9c;" title="Teal"></button>
                            <button type="button" class="color-preset" data-color="#e91e63" style="background: #e91e63;" title="Pink"></button>
                            <button type="button" class="color-preset" data-color="#34495e" style="background: #34495e;" title="Dark Gray"></button>
                            <button type="button" class="color-preset" data-color="#f1c40f" style="background: #f1c40f;" title="Yellow"></button>
                            <button type="button" class="color-preset custom-color" onclick="document.getElementById('partyColorPicker').click();" title="Custom Color">
                                <span style="font-size: 16px;">+</span>
                            </button>
                        </div>
                        <input type="color" id="partyColorPicker" style="display: none;" value="#3498db">
                        <input type="hidden" id="partyColor" value="#3498db">
                    </div>
                    <button onclick="addParty()" class="btn-primary">Add Party</button>
                </div>
                <div id="partiesList" class="items-list"></div>
            </section>

            <!-- Candidate Management Section -->
            <section class="card" id="candidatesSection" style="display: none;">
                <h2><span class="section-number">3</span>. Candidates</h2>
                <div class="input-group">
                    <input type="text" id="candidateName" placeholder="Candidate name">
                    <select id="candidateParty">
                        <option value="">Select Party</option>
                    </select>
                    <button onclick="addCandidate()" class="btn-primary">Add Candidate</button>
                </div>
                <div style="margin-bottom: 15px;">
                    <button onclick="autoGenerateCandidates()" class="btn-secondary">
                        âš¡ Auto-Generate One Candidate per Party
                    </button>
                </div>
                <div id="candidatesList" class="items-list"></div>
            </section>

            <!-- Voting Input Section -->
            <section class="card" id="votingSection" style="display: none;">
                <h2><span class="section-number">4</span>. Voting Results</h2>
                
                <!-- Autofill Button -->
                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                    <h4 style="margin: 0 0 10px 0; color: #856404;">âš¡ Quick Fill</h4>
                    <button onclick="autofillVotes()" class="btn-secondary" style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);">
                        ğŸ² Auto-Fill Random Votes
                    </button>
                    <p style="margin: 10px 0 0 0; font-size: 0.9em; color: #856404;">Automatically generates realistic vote totals for all candidates/parties</p>
                </div>
                
                <!-- Advanced Features (Python Backend) -->
                <div id="advancedFeatures" style="display: none; background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #2196f3;">
                    <h4 style="margin: 0 0 10px 0; color: #1976d2;">ğŸ Advanced Features (Python Backend)</h4>
                    
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                        <button onclick="showBallotGenerator()" class="btn-secondary" style="background: linear-gradient(135deg, #2196f3 0%, #21cbf3 100%);">
                            ğŸ² Generate Realistic Ballots
                        </button>
                        <button onclick="showStrategicSimulator()" class="btn-secondary" style="background: linear-gradient(135deg, #9c27b0 0%, #e91e63 100%);">
                            ğŸ¯ Simulate Strategic Voting
                        </button>
                        <button onclick="showBatchSimulator()" class="btn-secondary" style="background: linear-gradient(135deg, #ff9800 0%, #ff5722 100%);">
                            âš¡ Batch Simulation (100k voters)
                        </button>
                        <button onclick="saveCurrentScenario()" class="btn-secondary" style="background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);">
                            ğŸ’¾ Save & Share Scenario
                        </button>
                    </div>
                    
                    <!-- Ballot Generator Modal Content -->
                    <div id="ballotGeneratorPanel" style="display: none; background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <h5 style="margin-top: 0;">Generate Realistic Voter Ballots</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label>Number of Voters:</label>
                                <input type="number" id="genNumVoters" value="10000" min="100" max="1000000" style="width: 100%; padding: 8px; margin-top: 5px;">
                            </div>
                            <div>
                                <label>Ideological Distribution:</label>
                                <select id="genDistribution" style="width: 100%; padding: 8px; margin-top: 5px;">
                                    <option value="normal">Normal (Bell Curve)</option>
                                    <option value="polarized">Polarized (Two Extremes)</option>
                                    <option value="left">Left-Skewed</option>
                                    <option value="right">Right-Skewed</option>
                                    <option value="uniform">Uniform</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="generateRealisticBallots()" style="width: 100%; margin-top: 10px; padding: 10px; background: #2196f3; color: white; border: none; border-radius: 6px; cursor: pointer;">
                            Generate Ballots
                        </button>
                    </div>
                    
                    <!-- Strategic Voting Panel -->
                    <div id="strategicVotingPanel" style="display: none; background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <h5 style="margin-top: 0;">Strategic Voting Simulation</h5>
                        <p style="color: #666; font-size: 0.9em;">See how voters might vote tactically to avoid "wasted votes"</p>
                        <button onclick="runStrategicSimulation()" style="width: 100%; padding: 10px; background: #9c27b0; color: white; border: none; border-radius: 6px; cursor: pointer;">
                            Run Strategic Simulation
                        </button>
                        <div id="strategicResults" style="margin-top: 10px;"></div>
                    </div>
                    
                    <!-- Batch Simulation Panel -->
                    <div id="batchSimPanel" style="display: none; background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <h5 style="margin-top: 0;">Batch System Comparison</h5>
                        <p style="color: #666; font-size: 0.9em;">Run large-scale simulation across multiple systems simultaneously</p>
                        <div style="margin: 10px 0;">
                            <label><input type="checkbox" value="fptp" checked> FPTP</label>
                            <label style="margin-left: 15px;"><input type="checkbox" value="irv" checked> IRV</label>
                            <label style="margin-left: 15px;"><input type="checkbox" value="stv" checked> STV</label>
                        </div>
                        <button onclick="runBatchSimulation()" style="width: 100%; padding: 10px; background: #ff9800; color: white; border: none; border-radius: 6px; cursor: pointer;">
                            Run Batch Simulation (100,000 voters)
                        </button>
                        <div id="batchResults" style="margin-top: 10px;"></div>
                    </div>
                </div>
                
                <!-- Race Type Selection -->
                <div class="race-type-selector">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #667eea;">
                        Election Scope:
                    </label>
                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                        <label class="radio-option" id="singleRaceOption">
                            <input type="radio" name="raceType" id="singleRaceRadio" value="single" checked onchange="updateRaceType()">
                            <span>ğŸ Single Race (1 seat or district)</span>
                        </label>
                        <label class="radio-option" id="legislativeRaceOption">
                            <input type="radio" name="raceType" id="legislativeRaceRadio" value="legislative" onchange="updateRaceType()">
                            <span>ğŸ›ï¸ Entire Legislature (10 seats)</span>
                        </label>
                        
                        <div id="legislatureSeatsContainer" style="display: none; align-items: center; gap: 15px; margin-left: 20px; flex-wrap: wrap; width: 100%;">
                            <label for="totalLegislatureSeats" style="font-weight: 600; color: #667eea;">Seats:</label>
                            <input type="number" id="totalLegislatureSeats" value="100" min="2" max="1000" 
                                   style="width: 80px; padding: 8px; border: 2px solid #e0e0e0; border-radius: 8px;">
                            
                            <select id="parliamentPresets" onchange="applyParliamentPreset()" 
                                    style="padding: 8px; border-radius: 8px; border: 2px solid #e0e0e0; font-size: 14px; min-width: 180px;">
                                <option value="">-- Real-World Presets --</option>
                                <option value="349">ğŸ‡¸ğŸ‡ª Sweden (349)</option>
                                <option value="598">ğŸ‡©ğŸ‡ª Germany (598)</option>
                                <option value="435">ğŸ‡ºğŸ‡¸ US House (435)</option>
                                <option value="650">ğŸ‡¬ğŸ‡§ UK Commons (650)</option>
                                <option value="465">ğŸ‡¯ğŸ‡µ Japan (465)</option>
                                <option value="120">ğŸ‡³ğŸ‡¿ New Zealand (120)</option>
                                <option value="160">ğŸ‡®ğŸ‡ª Ireland DÃ¡il (160)</option>
                            </select>
                        </div>
                    </div>
                    <p id="raceTypeDescription" style="color: #666; font-size: 0.9em; font-style: italic; margin-bottom: 20px;">
                        Single race: Simulate one electoral district or seat (e.g., one House district).
                    </p>
                </div>
                
                <div id="electoralThresholdContainer" style="display: none; margin-bottom: 20px;">
                    <label for="electoralThreshold" style="display: block; margin-bottom: 8px; font-weight: 600; color: #667eea;">
                        Electoral Threshold (%)
                        <span class="info-icon" style="position: relative; display: inline-block; margin-left: 8px; cursor: help;">
                            <span style="color: #667eea; font-size: 1.1em;">â„¹ï¸</span>
                            <div class="threshold-tooltip" style="
                                position: absolute;
                                bottom: 125%;
                                left: 50%;
                                transform: translateX(-50%);
                                margin-bottom: 8px;
                                padding: 12px 16px;
                                background: #2d3748;
                                color: white;
                                border-radius: 8px;
                                font-size: 0.9em;
                                white-space: normal;
                                min-width: 280px;
                                opacity: 0;
                                pointer-events: none;
                                transition: opacity 0.2s;
                                z-index: 1000;
                                box-shadow: 0 4px 6px rgba(0,0,0,0.2);
                            ">
                                <div style="font-weight: 600; margin-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 6px;">
                                    Real-World Thresholds:
                                </div>
                                <div style="line-height: 1.8;">
                                    <div><strong>0.25% - 2%:</strong> Netherlands, Denmark, South Africa</div>
                                    <div><strong>3% - 5%:</strong> Germany, Sweden, New Zealand, Greece, Czechia, Norway, Austria</div>
                                    <div><strong>7% - 10%:</strong> Turkey, Russia, Liechtenstein</div>
                                </div>
                                <div style="
                                    position: absolute;
                                    bottom: -6px;
                                    left: 50%;
                                    transform: translateX(-50%);
                                    width: 0;
                                    height: 0;
                                    border-left: 6px solid transparent;
                                    border-right: 6px solid transparent;
                                    border-top: 6px solid #2d3748;
                                "></div>
                            </div>
                        </span>
                    </label>
                    <input type="number" id="electoralThreshold" min="0" max="100" step="0.1" value="5" 
                           style="width: 150px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                    <p style="margin-top: 8px; color: #666; font-size: 0.9em; font-style: italic;">
                        Minimum vote share (%) a party needs to win seats. Common values: 3%, 4%, or 5%
                    </p>
                </div>
                
                <div id="allocationMethodContainer" style="display: none; margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #667eea;">
                        Seat Allocation Method
                    </label>
                    <select id="allocationMethod" style="width: 250px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <option value="dhondt">D'Hondt (favors larger parties)</option>
                        <option value="sainte-lague">Sainte-LaguÃ« (more proportional)</option>
                    </select>
                    <p style="margin-top: 8px; color: #666; font-size: 0.9em; font-style: italic;">
                        D'Hondt tends to give bonus seats to larger parties; Sainte-LaguÃ« is more proportional to small parties.
                    </p>
                </div>
                
                <div id="mmpLevelingContainer" style="display: none; margin-top: 15px; margin-bottom: 20px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="mmpLevelingToggle" style="width: 18px; height: 18px;">
                        <span style="font-weight: 600; color: #667eea;">Enable Full Compensation (German Style)</span>
                    </label>
                    <p style="margin-top: 5px; font-size: 0.9em; color: #666; margin-left: 28px;">
                        When enabled, other parties receive "leveling seats" to restore proportionality when overhang occurs.
                    </p>
                </div>
                
                <div id="votingInputs"></div>
                
                <!-- Ranking Ballots Section (for IRV, STV, Borda, Condorcet) -->
                <div id="rankingBallotsSection" style="display: none; margin-top: 25px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ“Š Ranking Ballots</h3>
                    <p style="color: #666; margin-bottom: 15px;">
                        Define different ballot types showing voter preferences. Each ballot type represents a group of voters with the same ranking preferences.
                    </p>
                    
                    <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px;">
                        <label for="numBallotTypes" style="font-weight: 600; margin-right: 10px;">
                            Number of Ballot Types:
                        </label>
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <button type="button" onclick="decrementBallotTypes()" style="
                                width: 30px; 
                                height: 30px; 
                                padding: 0; 
                                border: 1px solid #ddd; 
                                border-radius: 4px; 
                                background: #f5f5f5; 
                                cursor: pointer;
                                font-size: 16px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                            ">âˆ’</button>
                            <input 
                                type="number" 
                                id="numBallotTypes" 
                                min="1" 
                                max="20" 
                                value="3" 
                                readonly
                                style="width: 80px; padding: 6px; border: 1px solid #ddd; border-radius: 4px; text-align: center;"
                            >
                            <button type="button" onclick="incrementBallotTypes()" style="
                                width: 30px; 
                                height: 30px; 
                                padding: 0; 
                                border: 1px solid #ddd; 
                                border-radius: 4px; 
                                background: #f5f5f5; 
                                cursor: pointer;
                                font-size: 16px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                            ">+</button>
                        </div>
                        <span style="margin-left: 10px; color: #666; font-size: 0.9em;">
                            (Max: 20 different ballot patterns)
                        </span>
                    </div>
                    
                    <div id="rankingBallotsContainer"></div>
                </div>
                
                <button onclick="calculateResults()" class="btn-calculate">ğŸ—³ï¸ Calculate Election Results</button>
            </section>

            <!-- Results Section -->
            <section class="card results-section" id="resultsSection" style="display: none;">
                <h2>ğŸ“Š Election Results</h2>
                <div id="results"></div>
                
                <h3>âš–ï¸ Arrow's Impossibility Theorem Analysis</h3>
                <div id="arrowAnalysis" class="arrow-analysis"></div>
            </section>


            <!-- AI Analysis Section -->
            <section class="card ai-analysis-section" id="aiAnalysisSection" style="display: none;">
                <h2>ğŸ¤– AI Expert Analysis</h2>
                <p>Get expert political science analysis of your election results using Mistral AI.</p>
                
                <button id="aiAnalysisBtn" class="btn-calculate" onclick="getAIAnalysisMain()" style="margin-top: 20px;">
                    <span>ğŸ”</span> Get AI Analysis of This Election
                </button>
                
                <div id="aiResponseMain" class="ai-response-main"></div>
            </section>
        </div>
    </div>

    <!-- Chart.js for improved visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        // Verify Chart.js loaded
        window.addEventListener('DOMContentLoaded', function() {
            if (typeof Chart === 'undefined') {
                console.error('âŒ Chart.js failed to load from CDN');
                alert('Chart library failed to load. Charts may not display correctly.');
            } else {
                console.log('âœ… Chart.js loaded successfully', Chart.version);
            }
        });
    </script>
    <script src="chartjs-wrapper.js"></script>
    <script src="tie-breaking.js"></script>
    <script src="round-by-round.js"></script>
    <script src="calculations.js"></script>
    <script src="state-manager.js"></script>
    <script src="api-client.js"></script>
    <script src="borda-condorcet.js"></script>
    <script src="enhanced-viz.js"></script>
    <script src="advanced-features.js"></script>
    <script src="ai-analysis-main.js"></script>
    <script src="country-import.js"></script>
    <script src="app.js"></script>
    
    <!-- AI Analysis Section (moved from learn-more.html) -->
    <div class="card" style="margin: 40px auto; max-width: 800px;">
        <h2>ğŸ¤– Ask AI for Election Analysis</h2>
        <p>Get expert analysis of your simulated election results using Mistral AI. The AI will analyze the systemic flaws, relevant voting principles, and suggest improvements.</p>
        
        <div class="warning-box" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 20px 0; border-radius: 4px;">
            <strong>âš ï¸ Note:</strong> This feature requires a Mistral AI API key. You'll need to add your API key to the code to use this feature.
        </div>
        
        <button id="aiAnalysisBtnLearn" class="btn-calculate" onclick="getAIAnalysisLearn()" style="margin-top: 20px;">
            <span>ğŸ”</span> Get AI Analysis of Last Election
        </button>
        
        <div id="aiResponseLearn" class="ai-response" style="margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 8px; display: none;"></div>
    </div>
    
    <!-- Share and Reset Simulator Buttons -->
    <div style="text-align: center; margin: 40px 0 20px 0; display: flex; gap: 15px; justify-content: center;">
        <button onclick="shareScenario()" 
                style="padding: 12px 24px; background: #667eea; color: white; border: none; 
                       border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;
                       box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: background 0.2s;">
            ğŸ”— Share Scenario
        </button>
        <button onclick="resetSimulator()" 
                style="padding: 12px 24px; background: #dc3545; color: white; border: none; 
                       border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;
                       box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: background 0.2s;">
            ğŸ”„ Reset Simulator
        </button>
    </div>
</body>
</html>

